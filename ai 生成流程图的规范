# 文档规范（Markdown / Mermaid）

## Mermaid 流程图规范（适配 VS Code 预览）

> 背景说明：
> - VS Code 的 `Markdown Preview Mermaid Support` 插件对 Mermaid 语法非常严格。
> - Mermaid 代码块里一旦出现不兼容/不合法语法，会直接报 `Parse error`，导致整张图无法渲染。

### 1) 基础写法（必须遵守）

- 必须使用标准 fenced code block：以 ` ```mermaid ` 开始，以 ` ``` ` 结束（不要缩进）。
- Mermaid 第一行必须是图类型与方向：`graph TD` 或 `flowchart TD`（二选一）。
- 节点 ID 只允许使用英文/数字/下划线（如：`A`、`A1`、`step_1`），不要用中文、空格、点号、特殊符号。
- 节点文字统一使用引号包裹，推荐写法：`A1["中文说明"]`，不要用 `A1[中文说明]` 混写。

### 2) 容易导致解析失败的写法（禁止）

- 不要在 Mermaid 节点文字中写 HTML（例如：`<br/>`、`<br>`、`<div>` 等）。
- 不要用 `\n`、`\t` 这类转义字符当“换行”（Mermaid 不会按你预期处理，容易触发解析错误）。
- 不要在 Mermaid 文本里直接塞复杂 SQL/代码片段（包含大量括号、引号、运算符时尤其容易报错）。
- 尽量避免在 Mermaid 文本里出现这些字符：`<`、`>`、`{`、`}`、`|`、`[`、`]`、`` ` ``。
  - 如果必须表达比较符号，优先改写为中文（如：`小于等于`、`大于等于`），或使用全角符号（如：`＜`、`＞`）。

### 3) 可读性与版式建议（避免“太大/太小/横向滚动”）

- 复杂流程优先采用“概览小图 + 分步骤中文说明”的上下结构，不要强行把所有细节塞进一张大图。
- 节点文字尽量短；大量字段/条件放到 Mermaid 代码块外，用 Markdown 列表写清楚。
- 需要标注连线含义时，优先用：`A -- 标签 --> B`（尽量少用 `A -->|标签| B`，避免 `|` 造成解析/排版问题）。
- 预览字体大小不要用 Mermaid init 强行放大，优先使用 VS Code 预览缩放：`Ctrl + 鼠标滚轮` 或 `Ctrl + + / Ctrl + -`。

### 4) 最小可用自检（修改后先跑这段）

```mermaid
graph TD
  A --> B
```
